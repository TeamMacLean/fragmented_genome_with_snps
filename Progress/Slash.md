Progress 18/3/14
========================================================

It turns out that the ratio of a normal distribution to a uniform distribution is a *slash* distribution:


```r
# Homozygous SNP list (normal)
hm <- rnorm(10000, 1e+07, 5e+06)
remove <- c()
x <- 1
for (i in hm) {
    if (i < 0 || i > 18585056) {
        remove <- c(remove, x)
    }
    x <- x + 1
}
hm <- hm[-c(remove)]

# Heterozygous SNP list (uniform)
ht <- runif(10000, 1, 18585056)

# Ratio of samples
ratio <- sample(hm, 1000)/sample(ht, 1000)  # numer. and denom. must be same length
```


I have decided that a good way to work out the ratio is by taking samples of the SNP distributions, then calculating the ratio of the sample vectors. With the SNP lists I was using in [New_Model_Genome](), this would not have been useful, as the number of homozygous SNPs in the model was so low.
From consulting literature that describes the kind of back-cross experiment I am modelling, including [Uchida et al (2011)](http://pcp.oxfordjournals.org/content/52/4/716.long), I have concluded that the actual numbers of SNPs can vary largely, based on the specific experiment. For subsequent versions of my model genome, I will use 10,000 of each kind of SNP. I can try and use experimental SNP data once I have got the genetic algorithm to re-order contigs from the model.



```r
par(mfrow = c(1, 2))  # puts 2 plots side by side

# Histogram of ratio
hist(ratio, xlim = c(-5, 5), breaks = c(-Inf, seq(-5, 5, 0.2), Inf), freq = F, 
    ylim = c(0, 0.7))

# Normal Q-Q plot
qqnorm(ratio, ylim = c(-5, 5))
qqline(ratio, xlim = c(-5, 5), lty = 2, col = "blue")
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2.png) 


As the above figures show, the ratio does not follow a normal distribution. Instead, as illustrated by the example below, we will have a slash distribution.


```r
set.seed(123)
X <- rnorm(10000)
Y <- runif(10000)
Z <- X/Y
dslash <- function(x) (dnorm(0) - dnorm(x))/x^2

x <- seq(-5, 5, 0.02)
hist(Z, xlim = c(-5, 5), breaks = c(-Inf, seq(-5, 5, 0.2), Inf), freq = F, ylim = c(0, 
    0.4))
lines(x, dslash(x), xlim = c(-5, 5), col = "red")
lines(x, dnorm(x), xlim = c(-5, 5), col = "blue", lty = 2)
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-31.png) 

```r

qqnorm(Z, ylim = c(-5, 5))
qqline(Z, xlim = c(-5, 5), lty = 2, col = "blue")
```

![plot of chunk unnamed-chunk-3](figure/unnamed-chunk-32.png) 



If the ratio follows the slash distribution, then we should be able to use Q-Q plot to compare it with an example slash.


```r
plot(density(ratio))
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-41.png) 

```r
ratio
```

```
##    [1] 7.268e-01 4.760e-01 1.108e+00 3.683e+00 1.990e+00 1.156e+00
##    [7] 1.091e+00 1.162e+00 3.576e-01 1.798e+00 4.679e-01 1.283e+00
##   [13] 1.297e+00 1.605e+00 3.364e+01 5.475e-01 6.951e-01 2.407e+00
##   [19] 8.126e-01 8.719e-01 1.267e+00 6.423e-01 7.810e+00 6.366e-01
##   [25] 6.166e-01 8.274e-01 8.525e-01 6.842e-01 2.123e+00 7.759e+00
##   [31] 1.649e+00 1.323e+00 1.491e+00 3.104e+02 6.597e-01 3.126e-01
##   [37] 1.323e+00 2.899e-02 5.815e+00 4.148e+00 5.977e-01 1.065e+00
##   [43] 1.842e+00 7.386e-01 2.830e-01 4.452e+00 3.082e-01 1.017e+00
##   [49] 1.567e+00 4.450e-01 1.036e+00 1.524e+00 8.113e-01 3.815e-01
##   [55] 4.516e+00 1.912e+00 8.376e-01 1.902e+00 6.279e-01 9.094e-01
##   [61] 3.039e+00 7.541e-01 7.182e-01 1.124e+00 3.262e-01 1.115e+00
##   [67] 1.246e+00 3.711e+00 1.127e+00 9.327e-01 4.338e+01 2.923e+00
##   [73] 4.360e-01 1.249e+00 2.507e+00 5.640e-01 1.378e+00 1.022e-01
##   [79] 2.043e+00 3.201e-01 8.211e-01 6.138e-01 1.357e+00 8.226e-01
##   [85] 8.684e-01 1.637e+00 9.382e-01 7.298e-01 1.879e+00 1.049e+00
##   [91] 1.292e+00 5.262e-01 1.354e+00 4.504e-01 7.544e+00 1.344e+00
##   [97] 1.009e+00 2.638e+01 1.026e-01 8.137e-01 3.450e+00 7.273e+00
##  [103] 1.128e+00 9.276e-01 1.512e+00 1.216e+00 5.564e-01 2.456e+00
##  [109] 2.413e+00 1.449e+00 5.844e+00 3.519e+00 4.019e-01 1.065e+00
##  [115] 1.845e+00 9.742e-01 4.155e-01 3.673e+01 6.170e-01 1.192e-01
##  [121] 2.717e+00 5.253e+00 3.450e-01 1.752e-01 6.556e+00 1.550e+00
##  [127] 4.075e+02 2.886e+00 1.231e+00 1.007e+00 1.108e+00 5.844e+01
##  [133] 2.635e+00 7.327e-01 4.224e-01 6.522e-01 1.075e+00 7.464e-01
##  [139] 4.518e+00 3.875e+00 1.139e+00 1.749e+00 4.659e-01 1.635e+00
##  [145] 6.960e-01 4.410e+00 1.654e+00 1.558e+00 1.471e+01 4.728e-01
##  [151] 1.459e+00 3.455e+01 1.916e+00 1.635e+00 6.932e-01 3.100e-01
##  [157] 1.197e+00 7.143e-01 6.818e-01 3.853e+00 1.030e+00 8.207e+00
##  [163] 7.885e-01 6.105e-01 7.939e-01 7.334e-01 1.292e+00 5.834e-01
##  [169] 3.066e+00 4.104e+00 2.831e-01 1.226e+00 1.192e+00 9.641e-01
##  [175] 2.969e+01 3.096e+00 1.028e+00 1.517e+01 2.452e+01 1.857e+00
##  [181] 3.204e+00 9.695e-01 2.989e-01 1.082e+00 1.120e-01 3.280e+00
##  [187] 8.498e-01 8.902e-01 1.096e+00 1.107e+00 1.115e+00 2.854e+00
##  [193] 5.808e-01 3.523e+00 8.151e-01 5.177e+00 8.220e-01 6.247e-02
##  [199] 2.836e-01 5.435e-01 9.308e-01 1.378e+00 2.589e+00 1.699e+00
##  [205] 8.154e-01 2.670e+00 5.011e+00 2.743e+00 8.197e-01 1.052e+01
##  [211] 2.281e+00 1.125e+00 1.018e+00 4.927e-01 2.435e-01 5.335e-01
##  [217] 4.383e-01 9.986e-01 3.400e+00 1.826e+01 2.287e+00 4.057e-01
##  [223] 1.471e+00 4.988e+01 4.305e-01 1.722e+00 5.309e-01 6.712e-01
##  [229] 6.964e+01 3.011e+00 2.304e+00 7.302e-01 4.661e-01 2.052e+00
##  [235] 1.172e+00 6.038e-01 1.332e+00 1.133e+00 5.299e-01 1.299e+00
##  [241] 5.358e-01 1.983e+00 1.019e+00 1.205e+00 2.200e+00 2.343e-01
##  [247] 6.427e-01 1.287e+00 7.005e-01 1.419e+00 4.738e+00 7.346e-01
##  [253] 4.016e+00 5.640e-01 1.085e+00 2.491e+01 2.258e+00 1.676e+00
##  [259] 3.179e-01 9.267e-01 1.183e+00 9.520e-01 9.507e-01 7.696e-01
##  [265] 9.312e-01 2.904e+00 4.910e-01 1.061e+00 7.591e-01 5.425e-01
##  [271] 9.960e-01 2.228e+00 7.511e-01 1.011e+00 9.950e-01 2.120e-02
##  [277] 1.475e+00 7.447e-01 9.354e-01 8.186e-01 8.720e-01 1.199e+00
##  [283] 4.790e+00 9.246e-01 4.890e+00 2.225e+00 3.205e+00 6.228e-01
##  [289] 1.370e+00 1.731e+00 1.313e+00 1.423e+01 4.337e+00 1.628e+01
##  [295] 1.397e+00 1.134e+00 1.372e+00 4.943e-01 7.705e-01 6.704e-01
##  [301] 4.851e-01 7.952e-01 5.227e-01 5.606e+00 7.478e-01 1.127e+00
##  [307] 1.130e+00 1.968e+00 2.069e-01 2.468e+00 5.144e-01 4.721e-01
##  [313] 1.486e+00 7.285e-01 5.387e+00 3.698e-01 3.397e+00 2.667e+00
##  [319] 1.600e+00 5.895e-01 1.547e+00 1.741e+00 6.593e-01 1.409e+01
##  [325] 4.606e-01 2.933e+00 1.252e-01 7.463e-01 4.899e+00 7.762e-01
##  [331] 2.813e-01 1.388e+00 4.976e+00 2.784e-01 4.851e-01 4.184e+00
##  [337] 6.036e+00 1.065e+00 8.611e-01 6.483e-01 4.923e+00 4.261e+00
##  [343] 1.085e+00 5.812e-01 1.380e+00 2.684e-01 1.581e+00 5.042e-01
##  [349] 5.337e-01 1.106e+00 5.091e+00 8.171e-01 2.267e+00 1.458e+00
##  [355] 1.874e+00 1.035e+00 2.800e-01 1.501e+00 4.875e-01 9.216e-01
##  [361] 1.405e+00 1.188e+00 2.861e+00 5.111e-01 4.261e+00 1.409e+00
##  [367] 1.924e+00 2.750e+00 1.608e+00 2.466e+00 1.197e+01 6.377e-01
##  [373] 1.417e-01 1.566e+00 5.364e-01 1.043e+00 4.198e-01 4.822e+00
##  [379] 3.683e-01 5.663e-01 3.171e+00 1.837e+00 9.977e-01 4.734e+00
##  [385] 8.684e-01 6.278e-01 7.959e-01 1.345e-01 1.765e+00 1.649e-01
##  [391] 3.124e-01 2.401e+01 3.098e+00 3.130e+00 6.686e-01 1.635e+00
##  [397] 2.991e+00 6.159e-01 5.752e-01 1.086e-01 1.836e+00 5.999e-01
##  [403] 2.559e+00 2.453e+00 1.388e-01 3.919e+00 1.849e+00 1.248e+00
##  [409] 1.119e+00 6.070e-01 5.666e-01 7.535e-01 5.566e-01 9.466e-01
##  [415] 6.971e-01 2.291e+01 9.759e-01 6.955e+00 3.980e+02 1.996e+00
##  [421] 2.314e-01 6.543e-01 8.046e-01 1.093e+00 3.333e-01 1.355e+00
##  [427] 9.455e-01 8.614e-01 1.467e+00 8.422e-01 1.765e+00 8.428e-01
##  [433] 6.897e-01 9.241e-01 6.551e-01 5.140e+00 1.247e+01 2.852e+00
##  [439] 1.522e+00 5.521e-01 4.779e-01 3.968e+00 5.467e-01 3.884e+00
##  [445] 8.163e-01 7.325e-01 3.722e+00 9.596e-01 4.359e-01 4.421e-01
##  [451] 1.038e+00 2.699e+00 3.769e+00 6.390e-01 2.249e-01 1.567e+00
##  [457] 5.437e-01 7.429e-01 8.561e-01 1.187e-01 1.013e+00 2.373e+00
##  [463] 2.701e-02 4.641e+01 2.475e+01 1.820e+00 1.549e+00 8.974e-01
##  [469] 2.564e-01 6.192e-01 2.026e-01 3.607e+00 8.884e-01 1.920e+00
##  [475] 5.057e-01 1.383e+00 2.853e+01 9.180e-01 3.959e+00 1.549e+00
##  [481] 8.617e-01 1.247e+00 7.210e-01 6.277e-01 1.595e+00 8.479e-01
##  [487] 1.121e+00 7.528e-01 4.885e-01 4.517e+00 1.926e+00 5.550e-01
##  [493] 9.865e+01 1.542e+00 8.059e-01 2.119e+00 4.105e-01 4.254e-01
##  [499] 1.772e+00 2.714e+00 1.206e+00 9.533e-01 1.112e+00 1.285e+00
##  [505] 1.686e+00 1.586e+00 1.042e+00 3.832e-01 4.041e-01 2.163e-01
##  [511] 4.426e-01 1.583e+00 1.880e+00 5.557e+00 3.023e+00 8.403e-01
##  [517] 1.458e+00 4.255e+00 1.334e+00 3.341e-01 1.116e+00 1.874e+00
##  [523] 6.521e-01 5.926e-01 9.040e-01 9.481e-01 2.803e+00 8.981e-01
##  [529] 2.531e+00 9.523e-01 1.870e+00 7.126e+00 2.625e+00 5.248e-01
##  [535] 4.739e-01 1.204e+00 1.163e+00 7.561e-01 5.115e-01 2.998e+00
##  [541] 6.508e-01 1.557e+00 1.278e+00 6.862e-01 3.572e-01 5.309e+00
##  [547] 2.464e+00 6.818e-01 3.012e+01 2.283e+00 6.070e-01 3.638e-01
##  [553] 6.166e-01 1.804e+00 8.708e-01 2.808e+00 8.128e+00 5.630e-01
##  [559] 2.351e+00 3.644e-01 2.035e+00 6.666e-01 1.652e+00 1.082e+00
##  [565] 1.438e+00 1.240e+00 6.617e-01 7.814e-01 1.670e+01 7.383e-01
##  [571] 4.549e+00 1.280e+00 2.168e-01 7.014e-01 1.440e+00 3.178e-01
##  [577] 8.013e-01 2.705e+00 2.267e+01 9.901e-01 3.197e+00 1.780e+00
##  [583] 1.490e+00 8.117e-01 9.403e-01 1.139e+01 1.292e+00 1.129e+00
##  [589] 1.150e+00 6.075e+00 1.015e+00 9.935e-01 1.404e+00 6.814e-01
##  [595] 7.041e-01 3.596e-01 1.526e+00 1.411e+00 2.219e+00 1.905e+00
##  [601] 2.327e+00 3.383e+00 1.595e+00 1.555e+01 6.459e-01 1.291e+00
##  [607] 5.627e-01 1.497e+00 5.067e+03 2.840e+00 2.161e+00 1.903e+00
##  [613] 8.029e-01 6.766e-01 1.850e+00 1.050e+00 6.575e+02 1.042e+00
##  [619] 5.962e-01 4.746e-01 4.427e+00 1.143e+00 1.491e+00 3.634e+00
##  [625] 4.276e+00 1.299e+00 2.302e+00 1.059e+00 8.050e-01 6.798e-01
##  [631] 7.405e-01 6.324e-01 2.983e-01 1.963e+00 1.843e+00 1.234e+00
##  [637] 9.882e-01 3.350e-01 3.900e-01 6.446e-01 1.774e+01 8.969e-01
##  [643] 8.158e-01 8.796e-01 4.261e-01 1.603e+00 1.314e+00 1.475e-01
##  [649] 9.730e-01 3.444e+00 2.811e-01 1.218e+00 1.650e+02 1.111e+00
##  [655] 7.609e-01 1.406e+00 5.521e-01 6.975e-01 2.894e+01 5.912e-01
##  [661] 1.516e+00 2.916e+01 2.039e+00 2.766e-01 6.107e+00 7.080e-01
##  [667] 2.696e-02 5.978e+00 3.215e+00 5.102e-01 2.901e+00 1.737e+00
##  [673] 4.442e-01 1.487e-01 1.335e+00 7.460e-01 9.206e-01 2.049e+00
##  [679] 7.761e-01 8.634e-01 9.546e-01 5.422e-01 3.404e+02 3.260e-01
##  [685] 1.030e+00 4.364e-01 1.212e+00 7.126e-01 7.886e-01 2.510e+00
##  [691] 1.741e+00 8.110e-01 2.354e+00 2.202e-01 5.061e-01 4.237e-01
##  [697] 1.625e+00 1.263e+00 9.481e+00 5.548e-01 3.008e+00 8.110e-01
##  [703] 3.290e+00 2.580e+00 1.019e+00 5.814e-01 3.669e+00 3.412e+00
##  [709] 6.957e-01 6.052e-01 2.699e-01 3.347e+00 2.632e+00 3.326e+00
##  [715] 1.080e+00 6.675e-01 7.816e-01 3.325e+01 1.800e+00 4.030e-01
##  [721] 5.195e+00 8.652e+00 1.451e-01 7.894e-01 4.346e-01 1.274e+01
##  [727] 7.310e-01 3.727e+00 6.720e-01 6.372e-01 1.653e+00 1.536e+00
##  [733] 5.310e-01 1.717e+00 1.047e+00 8.304e-01 1.980e+00 2.556e+00
##  [739] 4.492e-02 4.878e-01 8.334e-01 1.347e+00 1.764e+00 8.632e-01
##  [745] 1.448e+00 1.307e+00 8.847e-01 1.184e+00 8.291e-01 6.693e+00
##  [751] 2.969e+00 9.356e-01 2.914e-01 4.143e-01 8.115e-01 7.387e+00
##  [757] 8.761e-01 1.318e+00 7.885e-01 3.407e+00 6.473e-01 9.521e-01
##  [763] 1.472e+00 9.831e-01 9.080e-01 1.480e+00 8.589e-01 7.585e-01
##  [769] 6.061e-01 7.870e-01 1.734e+00 1.651e-01 3.502e-01 7.805e-01
##  [775] 4.532e-01 1.110e+00 2.909e+00 8.028e+00 1.854e+00 1.036e+00
##  [781] 1.549e+00 7.385e-02 1.874e-01 5.915e-01 9.902e-01 7.164e+01
##  [787] 9.383e-01 7.664e-01 1.844e-01 8.247e-01 5.893e+00 6.849e+00
##  [793] 8.271e-01 7.265e-01 1.576e+00 5.227e-01 1.423e+00 1.041e+00
##  [799] 2.497e+01 1.557e+00 8.038e-01 9.832e-01 1.080e+01 1.666e+00
##  [805] 1.055e+00 2.723e+00 3.316e-01 6.743e-01 1.622e+00 7.458e-01
##  [811] 2.347e+00 4.595e-01 2.150e+00 6.392e-01 7.944e-01 1.477e+00
##  [817] 1.506e-01 3.638e-01 5.775e-01 7.028e-01 1.639e+00 3.696e+00
##  [823] 1.945e+00 2.531e+01 5.257e+00 1.805e-01 6.363e+00 9.833e-01
##  [829] 2.339e-01 7.400e-01 4.112e+00 1.318e+00 1.510e-02 5.366e+00
##  [835] 3.383e-01 8.632e-01 7.087e-01 7.525e-01 3.497e-01 2.077e-01
##  [841] 1.727e+00 1.040e+00 6.037e-01 5.575e-01 7.700e-01 6.964e-01
##  [847] 1.789e+00 3.502e-01 2.568e+00 7.581e-01 1.705e+00 2.189e-01
##  [853] 8.152e-01 3.151e+01 7.424e-01 6.171e-01 7.247e-01 3.017e+00
##  [859] 1.420e+00 2.309e-01 7.650e-02 7.176e-01 2.451e+00 5.573e+00
##  [865] 3.123e+00 1.119e+00 1.745e+00 9.845e-01 4.239e+00 4.064e+00
##  [871] 1.661e+00 1.212e+00 3.194e+00 1.046e+00 2.267e+00 1.293e+01
##  [877] 6.607e-01 2.583e+00 2.210e-01 3.781e+01 9.062e-01 9.760e-01
##  [883] 5.451e-01 8.275e-01 1.425e+01 4.410e+00 7.441e-01 6.694e+00
##  [889] 7.312e-01 6.009e-01 1.584e+00 8.802e-01 3.650e+01 1.261e+00
##  [895] 3.397e-01 5.795e-01 1.961e+00 6.099e-01 4.355e-01 1.279e+00
##  [901] 2.153e+01 2.518e+00 5.147e-01 2.633e+00 1.231e+00 2.514e+00
##  [907] 4.082e-01 9.853e-01 7.485e-01 3.272e+00 5.134e-01 7.467e-01
##  [913] 7.774e-01 5.616e+00 2.785e-01 1.661e+00 8.203e-01 1.018e+00
##  [919] 2.314e-01 2.059e+00 5.310e-01 3.993e-01 3.085e+00 9.806e-01
##  [925] 7.679e-01 8.983e-01 1.203e+00 1.199e+00 3.760e+00 3.834e-01
##  [931] 1.582e+00 1.632e+00 8.357e+00 8.891e-01 5.582e-01 4.088e-01
##  [937] 1.828e+00 7.399e-01 1.156e+00 5.236e-01 1.072e+00 1.899e+00
##  [943] 5.714e-01 2.262e+00 1.002e+00 3.536e-01 2.870e-01 1.840e+00
##  [949] 2.351e-01 1.358e+00 1.173e+00 9.712e-01 1.764e+00 2.545e-01
##  [955] 4.979e-01 9.469e-01 7.581e-01 7.656e-01 7.091e-01 1.361e+00
##  [961] 1.147e+00 8.624e-01 5.799e-01 1.385e+00 7.414e-01 5.683e-01
##  [967] 1.063e+00 5.129e-01 1.913e+00 2.305e+00 1.500e+00 1.431e+01
##  [973] 1.713e+00 2.741e-01 2.543e+00 8.245e-01 4.935e-01 1.780e+00
##  [979] 1.469e+00 4.782e+00 8.472e-01 7.455e-01 4.627e+00 3.767e-01
##  [985] 3.605e-01 8.155e-01 1.948e+00 1.002e+01 4.574e-01 1.088e+00
##  [991] 1.140e+01 7.819e-01 1.397e+00 8.058e-01 5.550e-01 2.289e+00
##  [997] 3.500e+00 7.632e-01 8.603e-01 7.985e-01
```

```r
library("VGAM", lib.loc = "/Library/Frameworks/R.framework/Versions/3.0/Resources/library")
```

```
## Warning: package 'VGAM' was built under R version 3.0.2
```

```
## Loading required package: splines
## Loading required package: stats4
## 
## Attaching package: 'VGAM'
## 
## The following object is masked _by_ '.GlobalEnv':
## 
##     dslash
## 
## The following object is masked from 'package:stats4':
## 
##     coef
## 
## The following object is masked from 'package:splines':
## 
##     bs, ns
## 
## The following objects are masked from 'package:stats':
## 
##     case.names, coef, coefficients, df.residual, dfbeta, fitted,
##     fitted.values, formula, hatvalues, poly, residuals,
##     variable.names, weights
## 
## The following object is masked from 'package:base':
## 
##     identity, scale.default
```

```r
slash <- rslash(1000, mu = 1e+07, sigma = 5e+06)
qqp <- qqplot(slash, ratio)
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-42.png) 

